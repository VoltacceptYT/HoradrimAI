<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HoradrimAI Overlay</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background-color: #1a1a1a;
            font-family: 'Segoe UI', sans-serif;
            height: 100vh;
            overflow: hidden;
        }

        #ie7-overlay {
            position: fixed;
            top: 100px;
            left: 100px;
            width: 565px;
            height: 382px;
            background: rgba(180, 210, 255, 0.6);
            backdrop-filter: blur(14px) saturate(1.5) brightness(1.1);
            border: 0px solid rgba(120, 160, 220, 0.7);
            border-radius: 6px;
            box-shadow: 0 0 14px rgba(0, 0, 0, 0.45);
            z-index: 9999;
            display: flex;
            flex-direction: column;
            min-height: 0;
            font-family: 'Segoe UI', sans-serif;
            resize: both;
            overflow: hidden;
        }

        #ie7-header {
            background: linear-gradient(to bottom, rgba(255, 255, 255, 0.6), rgba(200, 220, 240, 0.4));
            padding: 4px 8px 4px 8px;
            cursor: move;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-bottom: 1px solid rgba(160, 160, 160, 0.5);
            user-select: none;
        }

        #ie7-titlebar {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        #ie7-title {
            display: flex;
            align-items: center;
            gap: 6px;
        }

        #ie7-title .ie7-title-icon {
            width: 16px;
            height: 16px;
            background-image: url('https://horadrimai.vercel.app/assets/icon.png');
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
            display: inline-block;
            flex-shrink: 0;
            image-rendering: auto;
            pointer-events: none;
            user-drag: none;
            -webkit-user-drag: none;
        }

        #ie7-title span {
            font-weight: bold;
            color: #1a1a1a;
            text-shadow: 0 1px 0 #fff;
        }

        .ie7-button {
            width: 26px;
            height: 26px;
            border: 1px solid #5a8ac6;
            border-radius: 50%;
            background: linear-gradient(to bottom, #dbeeff, #a4cfff);
            box-shadow: inset 0 1px 0 #ffffff;
            color: #003366;
            font-weight: bold;
            font-size: 14px;
            cursor: pointer;
            padding: 0;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .ie7-button:hover {
            background: linear-gradient(to bottom, #c0e0ff, #8fc4ff);
        }

        #ie7-controls {
            position: absolute;
            top: 0;
            right: 5px;
            display: flex;
        }

        #ie7-close {
            background: linear-gradient(to bottom, #f66, #c00);
            color: white;
            border: 1px solid #900;
            border-top-left-radius: 0;
            border-top-right-radius: 0;
            border-bottom-left-radius: 3px;
            border-bottom-right-radius: 3px;
            font-weight: bold;
            text-shadow: 0 -1px 0 #600;
            width: 52px;
            height: 18px;
            font-size: 12px;
            cursor: pointer;
            margin-bottom: 10px;
            margin-right: 2.5px;
        }

        #ie7-desktop-icon {
            position: fixed;
            top: 64px;
            left: 64px;
            width: 80px;
            text-align: center;
            font-size: 13px;
            font-family: 'Segoe UI', sans-serif;
            color: white;
            text-shadow: 1px 1px 2px black;
            cursor: default;
            z-index: 9999;
            display: none;
            user-select: none;
        }

        #ie7-desktop-icon .ie7-desktop-icon-img {
            width: 48px;
            height: 48px;
            background-image: url('https://horadrimai.vercel.app/assets/icon.png');
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
            margin-bottom: 4px;
            display: inline-block;
            pointer-events: none;
            user-drag: none;
            -webkit-user-drag: none;
        }

        #ie7-browser {
            flex: 1;
            width: 100%;
            border: none;
            min-height: 0;
        }
    </style>
</head>

<body>
    <div id="ie7-overlay">
        <div id="ie7-header">
            <div id="ie7-titlebar">
                <div id="ie7-title">
                    <span class="ie7-title-icon"></span>
                    <span>HoradrimAI</span>
                </div>
            </div>
            <div id="ie7-controls">
                <button id="ie7-close"><svg width="12px" height="12px" viewBox="-6 -6 24 24"
                        xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMinYMin" fill="currentColor">
                        <path
                            d='M7.314 5.9l3.535-3.536A1 1 0 1 0 9.435.95L5.899 4.485 2.364.95A1 1 0 1 0 .95 2.364l3.535 3.535L.95 9.435a1 1 0 1 0 1.414 1.414l3.535-3.535 3.536 3.535a1 1 0 1 0 1.414-1.414L7.314 5.899z' />
                    </svg>
                </button>
            </div>
        </div>
        <iframe id="ie7-browser" src="https://horadrimai.vercel.app/"></iframe>
    </div>

    <div id="ie7-desktop-icon">
        <span class="ie7-desktop-icon-img"></span>
        <div>HoradrimAI</div>
    </div>

    <script>
        (function () {
            'use strict';

            const GRID_SIZE = 64;

            const overlay = document.getElementById('ie7-overlay');
            const desktopIcon = document.getElementById('ie7-desktop-icon');

            // Drag overlay via header
            const header = document.getElementById('ie7-header');
            let draggingOverlay = false, offsetX = 0, offsetY = 0;
            header.addEventListener('mousedown', (e) => {
                draggingOverlay = true;
                offsetX = e.clientX - overlay.offsetLeft;
                offsetY = e.clientY - overlay.offsetTop;
                e.preventDefault();
            });
            document.addEventListener('mousemove', (e) => {
                if (draggingOverlay) {
                    overlay.style.left = `${e.clientX - offsetX}px`;
                    overlay.style.top = `${e.clientY - offsetY}px`;
                }
            });
            document.addEventListener('mouseup', () => draggingOverlay = false);

            // Drag desktop icon with grid snap
            let draggingIcon = false, iconOffsetX = 0, iconOffsetY = 0;
            desktopIcon.addEventListener('mousedown', (e) => {
                draggingIcon = true;
                iconOffsetX = e.clientX - desktopIcon.offsetLeft;
                iconOffsetY = e.clientY - desktopIcon.offsetTop;
            });
            document.addEventListener('mousemove', (e) => {
                if (draggingIcon) {
                    const x = Math.round((e.clientX - iconOffsetX) / GRID_SIZE) * GRID_SIZE;
                    const y = Math.round((e.clientY - iconOffsetY) / GRID_SIZE) * GRID_SIZE;
                    desktopIcon.style.left = `${x}px`;
                    desktopIcon.style.top = `${y}px`;
                }
            });
            document.addEventListener('mouseup', () => draggingIcon = false);

            // Double-click to restore
            desktopIcon.addEventListener('dblclick', () => {
                overlay.style.display = 'flex';
                desktopIcon.style.display = 'none';
            });

            // Close
            document.getElementById('ie7-close').onclick = () => {
                overlay.style.display = 'none';
                desktopIcon.style.display = 'block';
            };

            // Enable resizing
            overlay.addEventListener('mousedown', (e) => {
                if (e.target === overlay) {
                    const startWidth = overlay.offsetWidth;
                    const startHeight = overlay.offsetHeight;
                    const startX = e.clientX;
                    const startY = e.clientY;

                    function onMouseMove(e) {
                        overlay.style.width = `${startWidth + (e.clientX - startX)}px`;
                        overlay.style.height = `${startHeight + (e.clientY - startY)}px`;
                    }

                    function onMouseUp() {
                        document.removeEventListener('mousemove', onMouseMove);
                        document.removeEventListener('mouseup', onMouseUp);
                    }

                    document.addEventListener('mousemove', onMouseMove);
                    document.addEventListener('mouseup', onMouseUp);
                }
            });

        })();
    </script>
</body>

</html>